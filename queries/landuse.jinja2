{% macro ne_landuse_cols(kind) %}
    way_area::bigint AS area,
    '{{ kind }}' AS kind,
    'naturalearthdata.com' AS source,
    {% filter geometry %}the_geom{% endfilter %} AS __geometry__,
    gid AS __id__
{% endmacro %}

{% if 4 <= zoom < 6 %}

SELECT
    '' AS name,
    NULL as operator,
    {{ ne_landuse_cols('urban area') }}
FROM
    ne_50m_urban_areas
WHERE
    {{ bounds|bbox_filter('the_geom') }}

UNION ALL

SELECT
  name,
  operator,
  way_area::bigint AS area,
  COALESCE("boundary", "landuse", "leisure", "natural", "highway", "aeroway", "amenity", "tourism", "man_made", "power") AS kind,
  'openstreetmap.org' AS source,
  {% filter geometry %}way{% endfilter %} AS __geometry__,
  osm_id AS __id__
FROM
  planet_osm_polygon
WHERE
  {{ bounds|bbox_filter('way') }}
  AND boundary='national_park'
  AND (17.256-ln(way_area)/ln(4)) <= {{ zoom }}

{% elif 6 <= zoom < 9 %}

SELECT
    '' AS name,
    NULL as operator,
    {{ ne_landuse_cols('urban area') }}
FROM
    ne_10m_urban_areas
WHERE
    {{ bounds|bbox_filter('the_geom') }}

UNION ALL

SELECT
  name,
  operator,
  way_area::bigint AS area,
  COALESCE("boundary", "landuse", "leisure", "natural", "highway", "aeroway", "amenity", "tourism", "man_made", "power") AS kind,
  'openstreetmap.org' AS source,
  {% filter geometry %}way{% endfilter %} AS __geometry__,
  osm_id AS __id__
FROM
  planet_osm_polygon
WHERE
  {{ bounds|bbox_filter('way') }}
  AND boundary='national_park'
  AND (17.256-ln(way_area)/ln(4)) <= {{ zoom }}

{% else %}

SELECT
    name,
    way_area::bigint AS area,
    operator,
    COALESCE("boundary", "landuse", "leisure", "natural", "highway", "aeroway", "amenity", "tourism", "man_made", "power") AS kind,
    'openstreetmap.org' AS source,
    {% filter geometry %}way{% endfilter %} AS __geometry__,
    osm_id AS __id__,
    sport,
    religion,
    %#tags AS tags
FROM
    planet_osm_polygon
WHERE
    mz_is_landuse = TRUE
    AND {{ bounds|bbox_filter('way') }}
    {% if zoom <= 15 %}
    AND (17.256-ln(way_area)/ln(4)) <= {{ zoom }}
    {% endif %}

{% endif %}
